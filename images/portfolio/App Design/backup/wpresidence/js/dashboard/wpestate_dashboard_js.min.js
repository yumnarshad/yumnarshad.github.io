
jQuery(document).ready(function(a){jQuery(".per_listing_payment").click(function(c){c.preventDefault();var b=jQuery(this).attr("data-listingid");jQuery("#paymodal_"+b).show()});jQuery(".paymentmodal_close").click(function(b){jQuery(this).parents(".paymentmodal").hide()});a("#open_packages").on("click",function(b){a(".pack_description_row").slideToggle();jQuery(this).toggleClass("open_pack_on");a(".pack-listing:first").find(".buypackage").trigger("click")});a(".buy_package_sh a").on("click",function(b){if(parseInt(ajaxcalls_vars.userid,10)===0){b.preventDefault();jQuery("#modal_login_wrapper").show();jQuery("#modal_login_wrapper").find("[autofocus]").focus();jQuery("#loginpop").val("1")}});a("#invoice_start_date, #invoice_end_date, #invoice_type ,#invoice_status ").on("change",function(){wpestate_filter_invoices()});wpestate_print_invoice_page();a(".disable_listing").on("click",function(f){f.preventDefault();f.stopPropagation();var i=a(this).attr("data-postid");var h=wpestate_dashboard_js_vars.ajaxurl;var g=0;a(this).text(wpestate_dashboard_js_vars.processing);if(a(this).hasClass("disabledx")){g=1;a(this).removeClass("disabledx")}else{a(this).addClass("disabledx")}var d=a(this);var c=a(this).parents().eq(4);var b=0;if(jQuery(this).hasClass("disable_agent")){var e=jQuery("#wpestate_agent_actions").val();b=1}else{var e=jQuery("#wpestate_property_actions").val()}a.ajax({type:"POST",url:h,data:{action:"wpestate_disable_listing",security:e,prop_id:i,is_agent:b},success:function(k){var j="";if(g===1){d.empty().append('<i class="fas fa-play"></i>');c.find(".property_dashboard_status").html(wpestate_dashboard_js_vars.disabled);d.html(wpestate_dashboard_js_vars.disablelisting);if(jQuery(".page-template-user_dashboard_agent_list").length>0){j=wpestate_dashboard_js_vars.enableagent}else{j=wpestate_dashboard_js_vars.enablelisting}}else{if(jQuery(".page-template-user_dashboard_agent_list").length>0){j=wpestate_dashboard_js_vars.disableagent}else{j=wpestate_dashboard_js_vars.disablelisting}c.find(".property_dashboard_status").empty().html(wpestate_dashboard_js_vars.published)}location.reload()},error:function(j){}})});wpestate_dash_set_upload_plans();wpestate_dash_add_new_plan();wpestate_crm_add_comment_dashboard()});function wpestate_process_inaction(a){var b;window.scrollTo(0,0);b='<div class="modal fade" id="loadingmodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-dialog"><div class="modal-content"><div class="modal-body listing-submit"><span>'+a+"</div></div></div></div></div>";jQuery("body").append(b);jQuery("#loadingmodal").modal()}function wpestate_chart_total_listings_widget(g,e,c){if(!document.getElementById("myChart_widget_total")){return}var h=jQuery("#myChart_widget_total").get(0).getContext("2d");var f=new Chart(h);var a="  ";a=g;var d={labels:e,datasets:[{label:c,fillColor:"rgba(220,220,220,0.5)",strokeColor:"rgba(220,220,220,0.8)",highlightFill:"rgba(220,220,220,0.75)",highlightStroke:"rgba(220,220,220,1)",data:a},]};var i={title:"page views",scaleBeginAtZero:true,scaleShowGridLines:true,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:true,scaleShowVerticalLines:true,barShowStroke:true,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'};var b=new Chart(h,{type:"bar",data:d,options:i})}function wpestate_chart_total_listings_widget2(d,h,f){if(!document.getElementById("myChart_widget_total")){return}var b=document.getElementById("myChart_widget_total").get(0).getContext("2d");var c=new Chart(b);var g={labels:h,datasets:[{label:f,fillColor:"rgba(108, 93, 211, 0.85)",strokeColor:"rgba(108, 93, 211, 0.85)",highlightFill:"rgba(108, 93, 211, 0.85)",highlightStroke:"rgba(220,220,220,1)",data:d},]};var e={scaleBeginAtZero:true,scaleShowGridLines:true,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:true,scaleShowVerticalLines:true,barShowStroke:true,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>'};var a=new Chart(b,{type:"bar",data:g,options:e})}function wpestate_dash_set_upload_plans(){var a=jQuery(".aaiu-uploader-floor-plans").each(function(b){var c=jQuery(this).attr("id");wpestate_floorPlanImage(c)});jQuery(".wpestate_dash_delete_plan").click(function(b){jQuery(this).parents(".floor_plan_unit_wrapper").remove()})}function wpestate_dash_add_new_plan(){jQuery("#add_new_floor_plan").click(function(c){c.preventDefault();var b=jQuery(".floor_plan_unit_wrapper").length;b=parseInt(b)+1;var a='<div class="floor_plan_unit_wrapper"><div id="#aaiu-upload-imagelist-floor-plant"></div><div class="col-md-12"><label for="plan_title">'+wpestate_dashboard_js_vars.plan_title+'</label><a class="wpestate_dash_delete_plan" onclick="return confirm('+wpestate_dashboard_js_vars.are_you_sure+');">'+wpestate_dashboard_js_vars.delete_plan+'</a><input id="plan_title" type="text" size="36" name="plan_title[]" value="" ></div><div class="col-md-12"><label for="plan_description">'+wpestate_dashboard_js_vars.plan_description+'</label><textarea class="plan_description" type="text" size="36" name="plan_description[]" ></textarea></div><div class="col-md-6"><label for="plan_size">'+wpestate_dashboard_js_vars.plan_size+'</label><input id="plan_size" type="text" size="36" name="plan_size[]" value=""></div><div class="col-md-6"><label for="plan_rooms">'+wpestate_dashboard_js_vars.plan_rooms+'</label><input id="plan_rooms" type="text" size="36" name="plan_rooms[]" value=""></div><div class="col-md-6"><label for="plan_bath">'+wpestate_dashboard_js_vars.plan_bath+'</label><input id="plan_bath" type="text" size="36"name="plan_bath[]" value=""></div><div class="col-md-6"><label for="plan_price">'+wpestate_dashboard_js_vars.plan_price+'</label><input id="plan_price" type="text" size="36" name="plan_price[]" value=""></div><div class="col-md-6"><div id="upload-container"><div id="aaiu-upload-container"><div class="aaiu-upload-imagelist-floor-plan"></div><div id="imagelist"><img src="" class="floor_plan_image_thumb"><input class="floor_plan_image" type="hidden" size="36" name="floor_plan_image[]" value=""><input type="hidden" class="plan_image_attach" name="plan_image_attach[]" value=""></div><div id="aaiu-uploader-floor-plans-'+b+'"  class=" aaiu-uploader-floor-plans wpresidence_button wpresidence_success">'+wpestate_dashboard_js_vars.uploadnew+"</div></div></div></div></div>";jQuery(".section_floor_plan_unit_wrapper").append(a);var d="aaiu-uploader-floor-plans-"+b;wpestate_floorPlanImage(d);jQuery(".wpestate_dash_delete_plan").click(function(e){jQuery(this).parents(".floor_plan_unit_wrapper").remove()})})}function wpestate_floorPlanImage(b){var a=jQuery("#"+b).parents(".floor_plan_unit_wrapper");var c=new plupload.Uploader({runtimes:"html5,flash,html4",browse_button:b,file_data_name:"aaiu_upload_file",url:wpestate_dashboard_js_vars.ajaxurl+"?action=wpestate_me_upload",multi_selection:false,filters:{mime_types:[{title:wpestate_dashboard_js_vars.allow_file_type,extensions:"jpg,jpeg,gif,pdf,png"}],max_file_size:"12000kb",prevent_duplicates:true}});c.init();jQuery("#"+b).on("click",function(d){d.preventDefault();c.splice();c.refresh()});c.bind("FilesAdded",function(d,e){if(d.files.length>1){d.splice(1);return}plupload.each(e,function(f){});jQuery.each(e,function(g,f){a.find(".aaiu-upload-imagelist-floor-plan").append('<div id="'+f.id+'" class="floorplan_upload_notification">Uploading '+f.name+" ("+plupload.formatSize(f.size)+") <b></b></div>")});d.refresh();c.start()});c.bind("UploadProgress",function(d,e){jQuery("#"+e.id+" b").html(e.percent+"%")});c.bind("Error",function(d,e){jQuery("#aaiu-upload-imagelist-floor-plant").append("<div>Error: "+e.code+", Message: "+e.message+(e.file?", File: "+e.file.name:"")+"</div>");d.refresh()});c.bind("FileUploaded",function(d,f,e){var e=jQuery.parseJSON(e.response);if(e.success){a.find(".floor_plan_image").val(e.html);a.find(".floor_plan_image_thumb").attr("src",e.html);a.find(".plan_image_attach").val(e.attach);a.find(".floorplan_upload_notification").remove()}else{a.find(".floor_plan_image_thumb").attr("src","");a.find(".plan_image_attach").val("")}})}function wpestate_filter_invoices(){var f,b,e,d,a;b=jQuery("#invoice_start_date").val();e=jQuery("#invoice_end_date").val();d=jQuery("#invoice_type").val();a=jQuery("#invoice_status").val();var c=jQuery("#wpestate_invoices_actions").val();f=wpestate_dashboard_js_vars.ajaxurl;jQuery.ajax({type:"POST",url:f,dataType:"json",data:{action:"wpestate_ajax_filter_invoices",start_date:b,end_date:e,type:d,status:a,security:c},success:function(g){jQuery("#container-invoices").empty().append(g.results);jQuery("#invoice_confirmed").empty().append(g.invoice_confirmed)},error:function(g){}})}function wpestate_print_invoice_page(){jQuery(".print_invoice").on("click",function(b){var d,c,e;e=wpestate_dashboard_js_vars.ajaxurl;b.preventDefault();d=jQuery(this).attr("data-post-id");c=window.open("","Print Invoice","width=700 ,height=842");var a=jQuery("#wpestate_invoices_actions").val();jQuery.ajax({type:"POST",url:e,data:{action:"wpestate_ajax_create_print_invoice",propid:d,security:a},success:function(f){c.document.write(f);c.document.close();c.focus();setTimeout(function(){c.print()},3000)},error:function(f){}})})}function wpestate_crm_add_comment_dashboard(){jQuery("#crm_insert_comment").on("click",function(e){var b,f;b=jQuery(this).attr("data-postid");f=wpestate_dashboard_js_vars.ajaxurl;content=jQuery("#crm_new_commnet").val();var d=jQuery(this).attr("data-who");var a=jQuery(this).attr("data-date");if(content===""){return}var c=jQuery("#wpestate_crm_insert_note").val();jQuery.ajax({type:"POST",url:f,data:{action:"wpestate_crm_add_comment_dashboard",item_id:b,content:content,security:c,},success:function(h){if(h==="ok"){var g='<div class="comment_item"><div class="comment_name">'+d+'</div><div class="comment_date">on '+a+'</div><div class="comment_content">'+content+"</div></div>"}else{var g='<div class="comment_item">'+h+"</div>"}jQuery("#show_notes_wrapper").prepend(g);jQuery("#crm_new_commnet").val("")},error:function(g){}})})};